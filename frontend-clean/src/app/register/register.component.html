<div class="register-container">
    <h2>Créer un compte</h2>

    @if (errorMessage) {
    <div class="alert alert-danger">
        {{ errorMessage }}
    </div>
    }

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <!-- Prénom -->
        <div class="form-group">
            <label for="firstName">Prénom</label>
            <input type="text" id="firstName" formControlName="firstName" placeholder="Votre prénom"
                [class.invalid]="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched">
            @if (registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched) {
            <div class="validation-error">Le prénom est requis</div>
            }
        </div>

        <!-- Nom -->
        <div class="form-group">
            <label for="lastName">Nom</label>
            <input type="text" id="lastName" formControlName="lastName" placeholder="Votre nom"
                [class.invalid]="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched">
            @if (registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched) {
            <div class="validation-error">Le nom est requis</div>
            }
        </div>

        <!-- Email -->
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" formControlName="email" placeholder="Votre email"
                [class.invalid]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
            @if (registerForm.get('email')?.invalid && registerForm.get('email')?.touched) {
            <div class="validation-error">
                @if (registerForm.get('email')?.errors?.['required']) {
                <div>L'email est requis</div>
                }
                @if (registerForm.get('email')?.errors?.['email']) {
                <div>Email invalide</div>
                }
            </div>
            }
        </div>

        <!-- Mot de passe -->
        <div class="form-group">
            <label for="password">Mot de passe</label>
            <input type="password" id="password" formControlName="password" placeholder="Votre mot de passe"
                [class.invalid]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
            @if (registerForm.get('password')?.invalid && registerForm.get('password')?.touched) {
            <div class="validation-error">
                @if (registerForm.get('password')?.errors?.['required']) {
                <div>Le mot de passe est requis</div>
                }
                @if (registerForm.get('password')?.errors?.['minlength']) {
                <div>Minimum 6 caractères</div>
                }
            </div>
            }
        </div>

        <!-- Confirmation mot de passe -->
        <div class="form-group">
            <label for="confirmPassword">Confirmer le mot de passe</label>
            <input type="password" id="confirmPassword" formControlName="confirmPassword"
                placeholder="Confirmez votre mot de passe"
                [class.invalid]="registerForm.hasError('mismatch') || (registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched)">
            @if (registerForm.hasError('mismatch')) {
            <div class="validation-error">Les mots de passe ne correspondent pas</div>
            }
            @if (registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched &&
            !registerForm.hasError('mismatch')) {
            <div class="validation-error">La confirmation est requise</div>
            }
        </div>

        <!-- Rôle -->
        <div class="form-group">
            <label for="role">Rôle</label>
            <select id="role" formControlName="role"
                [class.invalid]="registerForm.get('role')?.invalid && registerForm.get('role')?.touched">
                @for (role of roles; track role) {
                <option [value]="role">{{ role }}</option>
                }
            </select>
        </div>

        <button type="submit" [disabled]="registerForm.invalid || isLoading">
            {{ isLoading ? 'Chargement...' : 'S\'inscrire' }}
        </button>
    </form>

    <div class="login-footer">
        <p>Déjà un compte ? <a routerLink="/login">Se connecter</a></p>
    </div>
</div>